<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>README : Stencila C++ documentation</title>
    <link rel="shortcut icon" href="http://static.stenci.la/favicon.png">
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxy.css" rel="stylesheet" type="text/css" />
</head>
<body class="stencila-fonts">
    <div class="notes" style="display:none">
        <!-- Generation information removed from footer to simplify output and placed here for now -->
        Generated on Sat Oct 3 2015 12:03:04 for Stencila by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.8.11
    </div>
    <div id="stencila-header">
        <a href="http://stenci.la"><img src="http://static.stenci.la/img/logo-name-tagline-500.png" alt="Stencila" style="width:220px"></a>
        <div class="stencila-details">
            <h1>C++ documentation</h1>
            <h2>Version 0.18-gb3abf42-dirty</h2>
        </div>
    </div>
    <div id="top">
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"><div class="image">
<img src="http://static.stenci.la/img/logo-name-tagline-500.png"  alt="Stencila" style="width:300px"/>
</div>
</div><h3>Status</h3>
<p>Issues: <a href="http://waffle.io/stencila/stencila">![Ideas](https://badge.waffle.io/stencila/stencila.svg?label=0+-+Ideas&amp;title=ideas)</a> <a href="http://waffle.io/stencila/stencila">![Ready](https://badge.waffle.io/stencila/stencila.svg?label=1+-+Ready&amp;title=ready)</a> <a href="http://waffle.io/stencila/stencila">![Doing](https://badge.waffle.io/stencila/stencila.svg?label=2+-+Doing&amp;title=doing)</a></p>
<p>Build: <a href="https://travis-ci.org/stencila/stencila">![Build](https://travis-ci.org/stencila/stencila.svg?branch=develop)</a></p>
<h3>Quick start</h3>
<p><a class="el" href="namespaceStencila.html">Stencila</a> is a platform for creating documents that are driven by data. The core engine is in C++ with thin wrappers in to R and Python (more languages to come). Here's a taste of what <a class="el" href="namespaceStencila.html">Stencila</a> does, illustrated using the R package, but with similar functionality available in the other packages.</p>
<p>Install the R package from our R repository:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;install.packages(&#39;stencila&#39;,repo=&#39;http://get.stenci.la/r&#39;)</div></div><!-- fragment --><p>There's an optional command line interface which you can install into your path:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;require(stencila)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;stencila:::install()</div></div><!-- fragment --><p><a class="el" href="namespaceStencila.html">Stencila</a> is based around stencils, you can create a stencil from strings, or files, of HTML or Cila (our stencil authoring language):</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# An empty stencil</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;s &lt;- Stencil()</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# A stencil from an HTML string</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;s &lt;- Stencil(&#39;html://The date is &lt;span data-text=&quot;date()&quot;&gt;&#39;)</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# A stencil from a Cila file</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;s &lt;- Stencil(&#39;file://stencil.cila&#39;)</div></div><!-- fragment --><p>Internally, stencils are represented by an XHTML tree structure that can be converted to/from HTML and Cila. You can set a stencil's content using HTML and get it back as Cila:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Set the stencil&#39;s content using HTML</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;s$html(&#39;The date is &lt;span data-text=&quot;date()&quot;&gt;&#39;)</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# Get the stencil&#39;s content as Cila</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;s$cila()</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;[1] &quot;The date is {text date()}&quot;</div></div><!-- fragment --><p>Stencils are similar to other template formats and can be rendered to produce textual and graphical outputs. The key difference with stencils is that the output gets embedded within the stencil itself. Or, to express it the other way around, the rendered document retains the template logic.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Load some data on irises</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;data(iris)</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# Create a stencil that calculates a summary statistic</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;s &lt;- Stencil(&#39;cila://The correlation between petal length and petal width was {text with(iris,cor(Petal.Length,Petal.Width))}.&#39;)</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# Render it</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;s$render()</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;# Get it&#39;s rendered content as HTML</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;s$html()</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;[1] &quot;&lt;p&gt;\n\tThe correlation between petal length and petal width was &lt;span data-text=\&quot;with(iris,cor(Petal.Length,Petal.Width))\&quot;&gt;0.962865431402796&lt;/span&gt;.\n&lt;/p&gt;&quot;</div></div><!-- fragment --><p>Most templating engines separate the source (the template) from the target (the document). Stencils are <a href="https://en.wikipedia.org/wiki/Automorphism">automorphic</a> the source (the stencil) is also the target (the stencil). And because stencil's are natively XHTML, this means that you can view, edit and re-render them in place, in your browser:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;s$view()</div></div><!-- fragment --><p>(We're currently doing some major refactoring of the front end Javascript so, depending on when you try this out, Stencil editing may not work too well/at all).</p>
<h3>Installing</h3>
<p>Head on over to the <a href="https://github.com/stencila/stencila/releases">releases page</a> for instructions on installing the <a class="el" href="namespaceStencila.html">Stencila</a> package for R or Python. <a class="el" href="namespaceStencila.html">Stencila</a> components are placed in a "store" on your machine. The default <a class="el" href="namespaceStencila.html">Stencila</a> store is <code>~/.stencila</code> but you can use other store directories and specify them in a semicolon separated list in an environment variable <code>STENCILA_STORES</code>.</p>
<h3>Versioning</h3>
<p>We are using <a href="http://semver.org/">semantic version numbers</a> so versions like "0.y.z" indicate that the library is still in initial development phase. It is still early days so the API will change frequently. Don't rely on API stability until the release of version 1.0.0.</p>
<h3>Contributing</h3>
<p>We appreciate any help with <a class="el" href="namespaceStencila.html">Stencila</a> development! The <a href="https://github.com/stencila/stencila/issues">issues list</a> is a good place for contributing ideas. Even better, visit the kanban board at <a href="https://waffle.io/stencila/stencila">waffle.io/stencila/stencila</a> or <a href="https://huboard.com/stencila/stencila">huboard.com/stencila/stencila</a> to see which issues are ready to be tackled.</p>
<h3>Building</h3>
<h4>Building quick start</h4>
<p>Running <code>make</code> will build the C++, Python and R packages in a subdirectory corresponding to <code>build/OS/ARCH/VERSION</code>. There are separate Makefile shortcuts. e.g</p>
<ul>
<li><code>make cpp-requires</code> : build all requirements for the C++ package</li>
<li><code>make cpp-requires-boost</code> etc : build the required Boost libraries</li>
<li><code>make cpp-package</code> : build the C++ package</li>
<li><code>make py-tests</code> : run Python tests suites</li>
<li><code>make r-package</code> : build the R package</li>
<li><code>make r-tests</code> : run R test suites</li>
<li><code>make r-install</code> : install the R package on the host machine</li>
</ul>
<p>These shortcut tasks should build necessary dependencies e.g. <code>r-tests</code> first builds the R package.</p>
<h4>Tool chain requirements</h4>
<p>The C++ libraries requires the usual build tool suspects e.g. make, cmake, git. <a class="el" href="namespaceStencila.html">Stencila</a> is developed and tested using <a href="https://gcc.gnu.org/">`g++`</a>. A recent version of <code>g++</code> (&gt;=4.8) supporting features of the C++11 standard is necessary.</p>
<h5>Linux</h5>
<p>Provisioning scripts are available for Linux which install the necessary build tools. These scripts can be run on your machine or simply perused to see what is needed. Currently, provisioning scripts are provided for:</p>
<ul>
<li><a href="provision-ubuntu-build-12.04.sh">Ubuntu 12.04</a></li>
<li><a href="provision-ubuntu-build-14.04.sh">Ubuntu 14.04</a></li>
</ul>
<h5>Windows</h5>
<p>For Microsoft Windows we recommend building under <a href="http://msys2.github.io/">MSYS2</a> which provides a up-to-date and convenient way of compiling using the <a href="http://mingw-w64.sourceforge.net/">MinGW-w64</a> Windows port of <code>g++</code>. This section provides a guide to setting up a toolchain for building <a class="el" href="namespaceStencila.html">Stencila</a> packages. Where possible, we use the MSYS2 package manager, <code>pacman</code> to install required dependencies. If a package is not available for <code>pacman</code> (see the list <a href="https://github.com/Alexpux/MSYS2-packages">here</a>) then we recommend installing via the <code>choco</code> package manager. If the <code>choco</code> package is out of date then we resort to manual installation.</p>
<ul>
<li>Install <a href="https://msys2.github.io/">MYSYS2</a> and <a href="https://chocolatey.org">Chocolatey</a>.</li>
<li>Open the MYSY2 shell and install necessary build tools and libraries using <code>pacman</code>: <pre class="fragment">  ```shell
  pacman -S base-devel cmake gcc git mingw-w64-x86_64-python2-pip msys2-devel unzip zip
  pacman -S openssl libssh2
  ```
</pre></li>
<li>Install R using the Windows installer provided at <a href="http://www.r-project.org/">http://www.r-project.org/</a> and make sure the R binary directory is added to the path e.g. <pre class="fragment">  ```shell
  setx path "%path%;C:\Program Files\R\R-3.2.1\bin"
  ```
</pre></li>
<li>Install required R packages: <pre class="fragment">  ```shell
  Rscript -e "install.packages(c('Rcpp','roxygen2','svUnit','XML'),repos='http://cran.us.r-project.org')"
  ```
</pre></li>
<li>If you want to deliver any of the <a class="el" href="namespaceStencila.html">Stencila</a> packages to <a href="http://get.stenci.la">http://get.stenci.la</a> (using Makefile recipes such as <code>cpp-deliver</code>, <code>r-deliver</code>) you will need to install the Amazon Web Services Command Line Interface. Although there is a Windows Installer is seems easier to install the <code>awscli</code> package into the MSYS2 environment as in Linux: <pre class="fragment">  ```shell
  pip install awscli
  ```

  For some reason, `aws configure` within an MSYS2 shell does not seem to work, so configure `aws` by adding the files described [here](http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html#cli-config-files):

  ```shell
  mkdir ~/.aws
  nano ~/.aws/credentials
  nano ~/.aws/config
  ```
</pre></li>
</ul>
<h4>C++ package requirements</h4>
<p>The <a class="el" href="namespaceStencila.html">Stencila</a> C++ package has a number of required dependencies. At present these are:</p>
<ul>
<li><a href="http://www.boost.org/">Boost</a></li>
<li><a href="http://libgit2.github.com/">libgit2</a></li>
<li><a href="http://pugixml.org/">pugixml</a></li>
<li><a href="https://code.google.com/p/rapidjson/">rapidjson</a></li>
<li><a href="http://w3c.github.com/tidy-html5/">tidy-html5</a></li>
<li><a href="https://github.com/zaphoyd/websocketpp">WebSocket++</a></li>
</ul>
<p>The [Makefile](Makefile) defines the required version of each of these libraries and <code>make cpp-requires</code> will build and install them in the <code>cpp/requires</code> directory.We have taken this approach of local installs to avoid clashes with different versions that may already be globally installed on your machine. Local installation is unusual for C/C++ libraries but allows for better management of dependencies and is a modern approach used in other languages (e.g. <a href="http://virtualenv.readthedocs.org/en/latest/virtualenv.html">virtualenv for Python</a> and the <a href="https://www.npmjs.org/doc/cli/npm-install.html">Node package manager</a>)</p>
<p>We link statically to these libraries and distribute a large dynamic library for each <a class="el" href="namespaceStencila.html">Stencila</a> package (e.g R and Python packages). On Linux this requires that all libraries are compiled with Position Independent Code (i.e. -fPIC gcc flag). An alternative would be to link dynamically to these libraries and then do some dependency checking on the user's machine to see which dynamic libaries need to be installed. Whilst distributing a large static library is not ideal, at present it is preferred over doing the more complex dependency checking which includes ensuring the right version of libraries is available. See <a href="http://stackoverflow.com/questions/1412080/distributing-with-boost-library">here</a> and <a href="http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html">here</a> for further discussion.</p>
<h4>Building and testing with Vagrant</h4>
<p><a href="https://www.vagrantup.com/">Vagrant</a> is a tool for creating lightweight, reproducible, and portable development environments. If you want to build <a class="el" href="namespaceStencila.html">Stencila</a> for different operating systems or architectures we recommend using Vagrant. The [Vagrantfile](Vagrantfile) includes multiple virtual machine (VM) configurations and uses the provisioning scripts to setup each VM with the tools needed to build <a class="el" href="namespaceStencila.html">Stencila</a>. See the comments at the top of the [Vagrantfile](Vagrantfile) for instructions.</p>
<h4>Building and testing on Windows</h4>
<p>If you are running Windows in a virtual machine (e.g. VirtualBox) for better performance it is recommended to use a build directory that is on the VM (instead of the default <code>stencila/build/OS/ARCH/VERSION</code> directory that is within a shared folder on the host). Within the <code>MinGW-w64 Win64</code> shell create a build directory on the guest VM, change into the <code>stencila</code> directory on the host (in this example, mapped to drive Z:) and then specify the build directory when invoking <code>make</code>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mkdir -p c:/build</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd /z</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;make cpp-package BUILD=c:/build</div></div><!-- fragment --><p>For some reason, the Makefile recipe <code>r-package</code> causes an error on Windows:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ make r-package BUILD=c:/build</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd /c/build/r/3.2; R CMD INSTALL --build stencila</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;* installing to library &#39;C:/Program Files/R/R-3.2.1/library&#39;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Error: ERROR: no permission to install to directory &#39;C:/Program Files/R/R-3.2.1/library&#39;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Makefile:950: recipe for target &#39;/c/build/r/3.2/stencila_0.15.1.zip&#39; failed</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;make: *** [/c/build/r/3.2/stencila_0.15.1.zip] Error 1</div></div><!-- fragment --><p>To work around this, run the <code>MinGW-w64 Win64 Shell</code> <em>as an administrator</em> and then run the build command from there e.g.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd /c/build/r/3.2</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;R CMD INSTALL --build stencila</div></div><!-- fragment --> </div></div><!-- contents -->
    
</body>
</html>
